
import React, { createContext, useContext, useState, ReactNode } from 'react';

export type Language = 'en' | 'fr' | 'zh-CN' | 'zh-TW';

type Translations = Record<string, string>;

const dictionaries: Record<Language, Translations> = {
  en: {
    appTitle: "QQQ Backtester",
    // Config Panel
    profiles: "Profiles",
    addProfile: "Add Profile",
    editProfile: "Edit Profile",
    runComparison: "Run Comparison",
    profileName: "Profile Name",
    chartColor: "Chart Color",
    strategy: "Patrimony Strategy",
    initialCapital: "Initial Capital",
    cashYield: "Cash Yield (Annual %)",
    recurringInv: "Recurring Inv.",
    amount: "Amount",
    freq: "Freq",
    monthly: "Monthly",
    quarterly: "Quarterly",
    yearly: "Yearly",
    contributionMonth: "Contribution Month",
    month_jan: "January",
    month_feb: "February",
    month_mar: "March",
    month_apr: "April",
    month_may: "May",
    month_jun: "June",
    month_jul: "July",
    month_aug: "August",
    month_sep: "September",
    month_oct: "October",
    month_nov: "November",
    month_dec: "December",
    targetAllocation: "Portfolio Allocation (Target)",
    contributionAllocation: "Contribution Allocation",
    cash: "Cash",
    dcaCash: "DCA Cash",
    // Strategies
    strat_noRebalance: "No Rebalancing",
    strat_rebalance: "Yearly Rebalancing",
    strat_smart: "Smart Adjust",
    // Leverage
    stockPledge: "Asset Pledge",
    loanRate: "Loan Rate %",
    maxLtv: "Liquidation LTV %",
    maintMargin: "Maint. Margin",
    pledgeRatioQQQ: "QQQ Pledge Ratio (0-1)",
    pledgeRatioQLD: "QLD Pledge Ratio (0-1)",
    pledgeRatioCash: "Cash Pledge Ratio (0-1)",
    annualCashOut: "Annual Cash Out",
    percentOfQqq: "% of Total Portfolio",
    fixedAmount: "Fixed $",
    inflationRate: "Inflation Rate %",
    leverageWarning: "*Collateral = Sum(Asset * Ratio). Liquidation if Debt > Max LTV of this Collateral.",
    interestType: "Interest Payment",
    interestMonthly: "Pay Monthly (Cash)",
    interestMaturity: "At Maturity (Simple)",
    interestCapitalized: "Capitalize (Compound)",
    riskSafe: "Conservative",
    riskModerate: "Standard",
    riskAggressive: "Aggressive",
    riskCritical: "Critical",
    ltvNote: "LTV and Maintenance Ratio are inverses. Lower LTV = Higher Safety Buffer.",
    ltvBasis: "LTV Basis",
    ltvTotalAssets: "Total Assets",
    ltvCollateral: "Collateral Value",
    // Dashboard
    simulationResults: "Simulation Results",
    comparingPerformance: "Comparing performance across",
    bestBalance: "Best Final Balance",
    bestCagr: "Best CAGR",
    bestIrr: "Best IRR",
    perspective_return: "Absolute Return Perspective",
    perspective_risk: "Risk & Drawdown Perspective",
    perspective_ratio: "Risk-Reward Ratio Perspective",
    lowestDrawdown: "Lowest Max Drawdown",
    bestSharpe: "Best Sharpe Ratio",
    realValue: "Purchasing Power (Real Value)",
    maxRecoveryTime: "Max Recovery Time",
    calmarRatio: "Calmar Ratio",
    worstYear: "Worst Year Return",
    atInflation: "at {rate}% inflation",
    painIndex: "Pain Index (Ulcer)",
    recoveryMonths: "months",
    bankruptcyAlert: "Bankruptcy Alert",
    bankruptcyDesc: "The following strategies failed adequacy checks (Debt > Max LTV) and were liquidated:",
    portfolioGrowth: "Portfolio Growth (Net Equity)",
    historicalDrawdown: "Historical Drawdown",
    cashAllocationAnalysis: "Cash Allocation Analysis",
    cashAnalysisDesc: "Visualizing cash drag (left axis) vs absolute cash amount (right axis).",
    equityPct: "Equity %",
    cashPct: "Cash %",
    cashAmount: "Cash Amount",
    perfComparison: "Performance Comparison",
    ltvChartTitle: "LTV / Risk Tracking",
    ltvChartDesc: "Tracks the Loan-to-Value (LTV) ratio over time. Higher LTV increases liquidation risk.",
    betaChartTitle: "Portfolio Beta (Risk Exposure)",
    betaChartDesc: "Weighted average Beta (QQQ=1, QLD=2, Cash=0) relative to Net Equity. Beta > 1 implies leverage.",
    col_strategy: "Strategy",
    col_balance: "Balance",
    col_cagr: "CAGR",
    col_irr: "IRR",
    col_maxDD: "Max DD",
    col_sharpe: "Sharpe",
    col_calmar: "Calmar",
    col_pain: "Pain",
    // Reports
    viewDetails: "View Details",
    reportTitle: "Financial Reports",
    tabJournal: "Monthly Journal",
    tabBalanceSheet: "Balance Sheet (Semi-Annual)",
    date: "Date",
    event: "Event",
    netCashFlow: "Net Cash Flow",
    assets: "Assets",
    liabilities: "Liabilities",
    equity: "Equity (Net Worth)",
    totalAssets: "Total Assets",
    totalDebt: "Total Debt",
    marginLtv: "LTV %",
    close: "Close",
    shares: "Shares",
    price: "Price",
    // Math Models
    math_title: "Performance Math Models",
    math_cagr: "CAGR",
    math_cagr_expl: "Compound Annual Growth Rate. Measures the mean annual growth rate of an investment assuming profits are reinvested.",
    math_cagr_formula: "CAGR = (End Value / Start Value)^(1/n) - 1",
    math_irr: "IRR",
    math_irr_expl: "Internal Rate of Return. The discount rate that makes the net present value (NPV) of all cash flows equal to zero. Solved via Newton-Raphson method.",
    math_irr_formula: "NPV = Σ (CashFlow_t / (1 + IRR)^t) = 0",
    math_dd: "Max Drawdown",
    math_dd_expl: "The maximum observed loss from a peak to a trough of a portfolio.",
    math_dd_formula: "MaxDD = (Peak Value - Trough Value) / Peak Value",
    math_sharpe: "Sharpe Ratio",
    math_sharpe_expl: "Measures risk-adjusted return. Excess return per unit of deviation.",
    math_sharpe_formula: "Sharpe = (Rp - Rf) / σp",
    math_calmar: "Calmar Ratio (IRR-based)",
    math_calmar_expl: "Measures return relative to drawdown risk. Using IRR as the numerator accounts for the timing of cash flows, making it more accurate for DCA strategies.",
    math_calmar_formula: "Calmar = IRR / Max Drawdown",
    math_pain: "Pain Index (Ulcer)",
    math_pain_expl: "Measures the depth and duration of drawdowns. Unlike Max Drawdown which is a single point, Pain Index captures the 'cumulative stress' of being in a亏损 state.",
    math_pain_formula: "Pain Index = Sqrt( Σ(Drawdown_t^2) / n )",
    // Misc
    done: "Done",
    dataRange: "Data Range",
    appDesc: "Simulates various QQQ (Nasdaq 100) and QLD (2x Leverage) strategies. Create multiple profiles to compare different allocations and patrimony strategies.",
    exportData: "Export All",
    importData: "Import All",
    downloadReport: "Download Professional Report",
    reportGeneratedBy: "Report generated by Strategy Backtester",
    strategyAnalysis: "Strategy Performance Analysis",
    executiveSummary: "Executive Summary",
    visualAnalysis: "Visual Performance Analysis",
    aiAnalysisNote: "AI-Analysis Segment: The following data is structured for AI parsing.",
    legalDisclaimer: "Disclaimer: This report is for simulation purposes only. Past performance does not guarantee future results."
  },
  fr: {
    appTitle: "Backtesteur QQQ",
    profiles: "Profils",
    addProfile: "Ajouter un profil",
    editProfile: "Modifier le profil",
    runComparison: "Lancer la comparaison",
    profileName: "Nom du profil",
    chartColor: "Couleur du graphique",
    strategy: "Stratégie Patrimoniale",
    initialCapital: "Capital Initial",
    cashYield: "Rendement Cash (Annuel %)",
    recurringInv: "Inv. Récurrent",
    amount: "Montant",
    freq: "Fréq.",
    monthly: "Mensuel",
    quarterly: "Trimestriel",
    yearly: "Annuel",
    contributionMonth: "Mois de contribution",
    month_jan: "Janvier",
    month_feb: "Février",
    month_mar: "Mars",
    month_apr: "Avril",
    month_may: "Mai",
    month_jun: "Juin",
    month_jul: "Juillet",
    month_aug: "Août",
    month_sep: "Septembre",
    month_oct: "Octobre",
    month_nov: "Novembre",
    month_dec: "Décembre",
    targetAllocation: "Allocation Portefeuille (Cible)",
    contributionAllocation: "Allocation des Contributions",
    cash: "Cash",
    dcaCash: "DCA Cash",
    strat_noRebalance: "Sans Rééquilibrage",
    strat_rebalance: "Rééquilibrage Annuel",
    strat_smart: "Ajustement Intelligent",
    stockPledge: "Nantissement",
    loanRate: "Taux d'emprunt %",
    maxLtv: "LTV Liquidation %",
    maintMargin: "Marge Maint.",
    pledgeRatioQQQ: "Ratio Nantissement QQQ (0-1)",
    pledgeRatioQLD: "Ratio Nantissement QLD (0-1)",
    pledgeRatioCash: "Ratio Nantissement Cash (0-1)",
    annualCashOut: "Retrait Cash Annuel",
    percentOfQqq: "% du Portefeuille Total",
    fixedAmount: "Fixe $",
    inflationRate: "Taux d'inflation %",
    leverageWarning: "*Collatéral = Somme(Actif * Ratio). Faillite si Dette > LTV Max du Collatéral.",
    interestType: "Paiement des intérêts",
    interestMonthly: "Mensuel (Cash)",
    interestMaturity: "À l'échéance (Simple)",
    interestCapitalized: "Capitalisé (Composé)",
    riskSafe: "Prudent",
    riskModerate: "Standard",
    riskAggressive: "Agressif",
    riskCritical: "Critique",
    ltvNote: "LTV et Marge de Maintien sont inverses. LTV plus bas = Meilleure sécurité.",
    ltvBasis: "Base de calcul LTV",
    ltvTotalAssets: "Actif Total",
    ltvCollateral: "Valeur Nantie",
    simulationResults: "Résultats de Simulation",
    comparingPerformance: "Comparaison des performances de",
    bestBalance: "Meilleur Solde Final",
    bestCagr: "Meilleur CAGR",
    bestIrr: "Meilleur TRI",
    perspective_return: "Perspective de Rendement Absolu",
    perspective_risk: "Perspective de Risque et Drawdown",
    perspective_ratio: "Perspective de Ratio Risque-Rendement",
    lowestDrawdown: "Drawdown le plus faible",
    bestSharpe: "Meilleur Ratio Sharpe",
    realValue: "Pouvoir d'Achat (Valeur Réelle)",
    maxRecoveryTime: "Temps de Récupération Max",
    calmarRatio: "Ratio de Calmar",
    worstYear: "Pire performance annuelle",
    atInflation: "à {rate}% d'inflation",
    painIndex: "Indice de Douleur (Ulcer)",
    recoveryMonths: "mois",
    bankruptcyAlert: "Alerte Faillite",
    bankruptcyDesc: "Les stratégies suivantes ont échoué aux contrôles de solvabilité et ont été liquidées :",
    portfolioGrowth: "Croissance du Portefeuille (Actif Net)",
    historicalDrawdown: "Drawdown historique",
    cashAllocationAnalysis: "Analyse Allocation Cash",
    cashAnalysisDesc: "Visualisation du cash drag (axe gauche) vs montant absolu (axe droit).",
    equityPct: "% Actions",
    cashPct: "% Cash",
    cashAmount: "Montant Cash",
    perfComparison: "Tableau de Performance",
    ltvChartTitle: "Suivi LTV / Risque",
    ltvChartDesc: "Suit le ratio Loan-to-Value (LTV) au fil du temps. Un LTV élevé augmente le risque de liquidation.",
    betaChartTitle: "Beta du Portefeuille (Exposition au Risque)",
    betaChartDesc: "Beta pondéré moyen (QQQ=1, QLD=2, Cash=0) par rapport à l'actif net. Beta > 1 implique un effet de levier.",
    col_strategy: "Stratégie",
    col_balance: "Solde",
    col_cagr: "CAGR",
    col_irr: "TRI",
    col_maxDD: "Max DD",
    col_sharpe: "Sharpe",
    col_calmar: "Calmar",
    col_pain: "Douleur",
    // Reports
    viewDetails: "Détails",
    reportTitle: "Rapports Financiers",
    tabJournal: "Journal Mensuel",
    tabBalanceSheet: "Bilan (Semestriel)",
    date: "Date",
    event: "Événement",
    netCashFlow: "Flux Net",
    assets: "Actifs",
    liabilities: "Passifs",
    equity: "Capitaux Propres",
    totalAssets: "Total Actifs",
    totalDebt: "Dette Totale",
    marginLtv: "LTV %",
    close: "Fermer",
    shares: "Parts",
    price: "Prix",
    // Math Models
    math_title: "Modèles Mathématiques",
    math_cagr: "CAGR",
    math_cagr_expl: "Taux de croissance annuel composé. Mesure le taux de croissance moyen en supposant le réinvestissement des profits.",
    math_cagr_formula: "CAGR = (Valeur Fin / Valeur Début)^(1/n) - 1",
    math_irr: "TRI",
    math_irr_expl: "Taux de Rentabilité Interne. Le taux d'actualisation qui rend la VAN de tous les flux de trésorerie nulle. Résolu via Newton-Raphson.",
    math_irr_formula: "VAN = Σ (Flux_t / (1 + TRI)^t) = 0",
    math_dd: "Drawdown Max",
    math_dd_expl: "La perte maximale observée d'un sommet à un creux.",
    math_dd_formula: "MaxDD = (Sommet - Creux) / Sommet",
    math_sharpe: "Ratio de Sharpe",
    math_sharpe_expl: "Mesure le rendement ajusté au risque. Rendement excédentaire par unité de déviation.",
    math_sharpe_formula: "Sharpe = (Rp - Rf) / σp",
    math_calmar: "Ratio de Calmar (basé sur le TRI)",
    math_calmar_expl: "Mesure le rendement par rapport au risque de retrait. L'utilisation du TRI comme numérateur prend en compte le calendrier des flux de trésorerie.",
    math_calmar_formula: "Calmar = TRI / Drawdown Max",
    math_pain: "Indice de Douleur (Ulcer Index)",
    math_pain_expl: "Mesure la profondeur et la durée des baisses. Contrairement au Drawdown Max, l'Indice de Douleur capture le 'stress cumulatif'.",
    math_pain_formula: "Pain Index = Sqrt( Σ(Baisse_t^2) / n )",
    done: "Terminé",
    dataRange: "Plage de données",
    appDesc: "Simule diverses stratégies QQQ (Nasdaq 100) et QLD (Levier 2x). Créez plusieurs profils pour comparer différentes allocations.",
    exportData: "Exporter tout",
    importData: "Importer tout",
    downloadReport: "Télécharger le rapport professionnel",
    reportGeneratedBy: "Rapport généré par le backtesteur de stratégie",
    strategyAnalysis: "Analyse de performance de la stratégie",
    executiveSummary: "Résumé exécutif",
    visualAnalysis: "Analyse visuelle de performance",
    aiAnalysisNote: "Segment d'analyse IA : Les données suivantes sont structurées pour l'analyse par IA.",
    legalDisclaimer: "Avertissement : Ce rapport est fourni à des fins de simulation uniquement. Les performances passées ne garantissent pas les résultats futurs."
  },
  'zh-CN': {
    appTitle: "QQQ 回测工具",
    profiles: "配置方案",
    addProfile: "添加方案",
    editProfile: "编辑方案",
    runComparison: "运行对比",
    profileName: "方案名称",
    chartColor: "图表颜色",
    strategy: "资产策略",
    initialCapital: "初始资金",
    cashYield: "现金年化收益率 (%)",
    recurringInv: "定投设置",
    amount: "金额",
    freq: "频率",
    monthly: "每月",
    quarterly: "每季",
    yearly: "每年",
    contributionMonth: "定投月份",
    month_jan: "1月",
    month_feb: "2月",
    month_mar: "3月",
    month_apr: "4月",
    month_may: "5月",
    month_jun: "6月",
    month_jul: "7月",
    month_aug: "8月",
    month_sep: "9月",
    month_oct: "10月",
    month_nov: "11月",
    month_dec: "12月",
    targetAllocation: "目标持仓比例",
    contributionAllocation: "定投分配比例",
    cash: "现金",
    dcaCash: "定投现金",
    strat_noRebalance: "无再平衡",
    strat_rebalance: "年度再平衡",
    strat_smart: "智能调整",
    stockPledge: "资产质押融资",
    loanRate: "贷款利率 %",
    maxLtv: "清算线 LTV %",
    maintMargin: "维持率",
    pledgeRatioQQQ: "QQQ 抵押率 (0-1)",
    pledgeRatioQLD: "QLD 抵押率 (0-1)",
    pledgeRatioCash: "现金抵押率 (0-1)",
    annualCashOut: "年度提取现金",
    percentOfQqq: "总资产百分比",
    fixedAmount: "固定金额",
    inflationRate: "通货膨胀率 %",
    leverageWarning: "*有效抵押品 = (QQQ*比率 + QLD*比率 + 现金*比率)。若负债 > 有效抵押品的 Max LTV，将面临清算。",
    interestType: "利息支付方式",
    interestMonthly: "按月支付 (现金)",
    interestMaturity: "到期支付 (单利)",
    interestCapitalized: "本金化 (复利)",
    riskSafe: "极其保守",
    riskModerate: "标准稳健",
    riskAggressive: "激进",
    riskCritical: "极高风险",
    ltvNote: "LTV 與維持率互為倒數。維持率 167% ≈ LTV 60% (安全)。",
    ltvBasis: "LTV 计算基准",
    ltvTotalAssets: "总资产市值",
    ltvCollateral: "有效抵押物市值",
    simulationResults: "模拟结果",
    comparingPerformance: "对比方案数量: ",
    bestBalance: "最高最终余额",
    bestCagr: "最高年化回报 (CAGR)",
    bestIrr: "最高内部收益率 (IRR)",
    perspective_return: "绝对收益视角",
    perspective_risk: "风险与回撤视角",
    perspective_ratio: "风险收益比视角",
    lowestDrawdown: "最低最大回撤",
    bestSharpe: "最高夏普比率",
    realValue: "真实购买力 (剔除通胀)",
    maxRecoveryTime: "最大回撤修复期",
    calmarRatio: "卡玛比率 (收益/风险)",
    worstYear: "最差年度回报",
    atInflation: "按 {rate}% 通胀率计",
    painIndex: "痛苦指数 (溃疡指数)",
    recoveryMonths: "个月",
    bankruptcyAlert: "破产警报",
    bankruptcyDesc: "以下策略未能满足适足率检查 (负债 > Max LTV) 并已被清算：",
    portfolioGrowth: "资产增长趋势 (净值)",
    historicalDrawdown: "历史回撤",
    cashAllocationAnalysis: "现金仓位分析",
    cashAnalysisDesc: "展示现金拖累比例 (左轴) vs 绝对现金金额 (右轴)。",
    equityPct: "股票 %",
    cashPct: "现金 %",
    cashAmount: "现金金额",
    perfComparison: "绩效对比表",
    ltvChartTitle: "风险追踪 (LTV / 维持率)",
    ltvChartDesc: "追踪贷款价值比 (LTV)。LTV 越高，清算风险越大。维持率 = 1 / LTV。",
    betaChartTitle: "投资组合 Beta (风险敞口)",
    betaChartDesc: "基于净资产加权的平均 Beta (QQQ=1, QLD=2, 现金=0)。Beta > 1 意味着带有杠杆。",
    col_strategy: "策略",
    col_balance: "余额",
    col_cagr: "年化回报",
    col_irr: "内部收益率",
    col_maxDD: "最大回撤",
    col_sharpe: "夏普比率",
    col_calmar: "卡玛比率",
    col_pain: "痛苦指数",
    // Reports
    viewDetails: "查看明细",
    reportTitle: "详细财务报告",
    tabJournal: "月度流水账",
    tabBalanceSheet: "家庭资产负债表 (半年度)",
    date: "日期",
    event: "交易事件",
    netCashFlow: "净现金流",
    assets: "资产项目",
    liabilities: "负债与权益",
    equity: "净资产 (权益)",
    totalAssets: "总资产",
    totalDebt: "总负债",
    marginLtv: "融资 LTV %",
    close: "关闭",
    shares: "股数",
    price: "市价",
    // Math Models
    math_title: "绩效指标数学模型",
    math_cagr: "复合年均增长率 (CAGR)",
    math_cagr_expl: "假设收益进行再投资的情况下，投资的平均年增长率。不考虑中间的现金流变化。",
    math_cagr_formula: "CAGR = (期末价值 / 期初价值)^(1/年数) - 1",
    math_irr: "内部收益率 (IRR)",
    math_irr_expl: "考虑了资金进出时间（如定投）的真实回报率。它是使所有现金流的净现值 (NPV) 等于零的折现率，使用牛顿迭代法求解。",
    math_irr_formula: "NPV = Σ (现金流_t / (1 + IRR)^t) = 0",
    math_dd: "最大回撤 (Max Drawdown)",
    math_dd_expl: "在选定周期内，任一时间点往后推，可能出现的最大账面损失。",
    math_dd_formula: "MaxDD = (历史峰值 - 历史谷值) / 历史峰值",
    math_sharpe: "夏普比率 (Sharpe Ratio)",
    math_sharpe_expl: "衡量风险调整后的收益。即每承受一单位总风险，可以产生多少超额回报。",
    math_sharpe_formula: "Sharpe = (平均回报率 - 无风险利率) / 回报率标准差",
    math_calmar: "卡玛比率 (基于 IRR)",
    math_calmar_expl: "衡量收益与最大回撤风险的比值。使用内部收益率 (IRR) 作为分子，能更准确地衡量包含定投等现金流场景下的真实风险回报比。",
    math_calmar_formula: "CalmarRatio = IRR / 最大回撤",
    math_pain: "痛苦指数 (Ulcer Index)",
    math_pain_expl: "衡量回撤的深度和持续时间。不同于最大回撤只记录单点最差情况，痛苦指数捕捉了处于亏损状态的“累积压力”。数值越低表示投资过程越平稳舒适。",
    math_pain_formula: "Pain Index = √[ Σ(当日回撤%^2) / 样本总数 ]",
    done: "完成",
    dataRange: "数据范围",
    appDesc: "模拟 QQQ (纳斯达克100) 和 QLD (2倍杠杆) 的多种投资策略。创建多个方案以对比不同的资产配置和现金管理逻辑。",
    exportData: "导出配置",
    importData: "导入配置",
    downloadReport: "下载专业报告 (PDF)",
    reportGeneratedBy: "由策略回测系统生成",
    strategyAnalysis: "投资策略绩效分析报告",
    executiveSummary: "核心绩效摘要",
    visualAnalysis: "图表可视化分析",
    aiAnalysisNote: "AI 分析专用 segment：以下数据已为 AI 解析进行结构化处理。",
    legalDisclaimer: "风险提示：本报告仅供模拟参考，过往业绩不代表未来表现。投资有风险，入市需谨慎。"
  },
  'zh-TW': {
    appTitle: "QQQ 回測工具",
    profiles: "配置方案",
    addProfile: "新增方案",
    editProfile: "編輯方案",
    runComparison: "執行對比",
    profileName: "方案名稱",
    chartColor: "圖表顏色",
    strategy: "資產策略",
    initialCapital: "初始資金",
    cashYield: "現金年化收益率 (%)",
    recurringInv: "定期定額設定",
    amount: "金額",
    freq: "頻率",
    monthly: "每月",
    quarterly: "每季",
    yearly: "每年",
    contributionMonth: "定投月份",
    month_jan: "1月",
    month_feb: "2月",
    month_mar: "3月",
    month_apr: "4月",
    month_may: "5月",
    month_jun: "6月",
    month_jul: "7月",
    month_aug: "8月",
    month_sep: "9月",
    month_oct: "10月",
    month_nov: "11月",
    month_dec: "12月",
    targetAllocation: "目標持倉比例",
    contributionAllocation: "定投分配比例",
    cash: "現金",
    dcaCash: "定投現金",
    strat_noRebalance: "無再平衡",
    strat_rebalance: "年度再平衡",
    strat_smart: "智能調整",
    stockPledge: "資產質押融資",
    loanRate: "貸款利率 %",
    maxLtv: "清算線 LTV %",
    maintMargin: "維持率",
    pledgeRatioQQQ: "QQQ 抵押率 (0-1)",
    pledgeRatioQLD: "QLD 抵押率 (0-1)",
    pledgeRatioCash: "現金抵押率 (0-1)",
    annualCashOut: "年度提取現金",
    percentOfQqq: "總資產百分比",
    fixedAmount: "固定金額",
    inflationRate: "通貨膨脹率 %",
    leverageWarning: "*有效抵押品 = (QQQ*比率 + QLD*比率 + 現金*比率)。若負債 > 有效抵押品的 Max LTV，將面臨清算。",
    interestType: "利息支付方式",
    interestMonthly: "按月支付 (現金)",
    interestMaturity: "到期支付 (單利)",
    interestCapitalized: "本金化 (複利)",
    riskSafe: "極其保守",
    riskModerate: "標準穩健",
    riskAggressive: "激進",
    riskCritical: "極高風險",
    ltvNote: "LTV 與維持率互為倒數。維持率 167% ≈ LTV 60% (安全)。",
    ltvBasis: "LTV 計算基準",
    ltvTotalAssets: "總資產市值",
    ltvCollateral: "有效抵押物市值",
    simulationResults: "模擬結果",
    comparingPerformance: "對比方案數量: ",
    bestBalance: "最高最終餘額",
    bestCagr: "最高年化回報 (CAGR)",
    bestIrr: "最高內部收益率 (IRR)",
    perspective_return: "絕對收益視角",
    perspective_risk: "風險與回撤視角",
    perspective_ratio: "風險收益比視角",
    lowestDrawdown: "最低最大回撤",
    bestSharpe: "最高夏普比率",
    realValue: "真實購買力 (剔除通脹)",
    maxRecoveryTime: "最大回撤修復期",
    calmarRatio: "卡瑪比率 (收益/風險)",
    worstYear: "最差年度回報",
    atInflation: "按 {rate}% 通脹率計",
    painIndex: "痛苦指數 (潰瘍指數)",
    recoveryMonths: "個月",
    bankruptcyAlert: "破產警報",
    bankruptcyDesc: "以下策略未能滿足適足率檢查 (負債 > Max LTV) 並已被清算：",
    portfolioGrowth: "資產增長趨勢 (淨值)",
    historicalDrawdown: "歷史回撤",
    cashAllocationAnalysis: "現金倉位分析",
    cashAnalysisDesc: "展示現金拖累比例 (左軸) vs 絕對現金金額 (右軸)。",
    equityPct: "股票 %",
    cashPct: "現金 %",
    cashAmount: "現金金額",
    perfComparison: "績效對比表",
    ltvChartTitle: "風險追蹤 (LTV / 維持率)",
    ltvChartDesc: "追蹤貸款價值比 (LTV)。LTV 越高，清算風險越大。維持率 = 1 / LTV。",
    betaChartTitle: "投資組合 Beta (風險敞口)",
    betaChartDesc: "基於淨資產加權的平均 Beta (QQQ=1, QLD=2, 現金=0)。Beta > 1 意味著帶有槓桿。",
    col_strategy: "策略",
    col_balance: "餘額",
    col_cagr: "年化回報",
    col_irr: "內部收益率",
    col_maxDD: "最大回撤",
    col_sharpe: "夏普比率",
    col_calmar: "卡瑪比率",
    col_pain: "痛苦指數",
    // Reports
    viewDetails: "查看明細",
    reportTitle: "詳細財務報告",
    tabJournal: "月度流水帳",
    tabBalanceSheet: "家庭資產負債表 (半年度)",
    date: "日期",
    event: "交易事件",
    netCashFlow: "淨現金流",
    assets: "資產項目",
    liabilities: "負債與權益",
    equity: "淨資產 (權益)",
    totalAssets: "總資產",
    totalDebt: "總負債",
    marginLtv: "融資 LTV %",
    close: "關閉",
    shares: "股數",
    price: "市價",
    // Math Models
    math_title: "績效指標數學模型",
    math_cagr: "複合年均增長率 (CAGR)",
    math_cagr_expl: "假設收益進行再投資的情況下，投資的平均年增長率。不考慮中間的現金流變化。",
    math_cagr_formula: "CAGR = (期末價值 / 期初價值)^(1/年數) - 1",
    math_irr: "內部收益率 (IRR)",
    math_irr_expl: "考慮了資金進出時間（如定投）的真實回報率。它是使所有現金流的淨現值 (NPV) 等於零的折現率，使用牛頓迭代法求解。",
    math_irr_formula: "NPV = Σ (現金流_t / (1 + IRR)^t) = 0",
    math_dd: "最大回撤 (Max Drawdown)",
    math_dd_expl: "在選定週期內，任一時間點往後推，可能出現的最大帳面損失。",
    math_dd_formula: "MaxDD = (歷史峰值 - 歷史谷值) / 歷史峰值",
    math_sharpe: "夏普比率 (Sharpe Ratio)",
    math_sharpe_expl: "衡量風險調整後的收益。即每承受一單位總風險，可以產生多少超額回報。",
    math_sharpe_formula: "Sharpe = (平均回報率 - 無風險利率) / 回報率標準差",
    math_calmar: "卡瑪比率 (基於 IRR)",
    math_calmar_expl: "衡量收益與最大回撤風險的比值。使用內部收益率 (IRR) 作為分子，能更準確地衡量包含定投等現金流場景下的真實風險回報比。",
    math_calmar_formula: "CalmarRatio = IRR / 最大回撤",
    math_pain: "痛苦指數 (Ulcer Index)",
    math_pain_expl: "衡量回撤的深度和持續時間。不同於最大回撤只記錄單點最差情況，痛苦指數捕捉了處於虧損狀態的“累積壓力”。數值越低表示投資過程越平穩舒適。",
    math_pain_formula: "Pain Index = √[ Σ(當日回撤%^2) / 樣本總數 ]",
    done: "完成",
    dataRange: "數據範圍",
    appDesc: "模擬 QQQ (納斯達克100) 和 QLD (2倍槓桿) 的多種投資策略。創建多個方案以對比不同的資產配置和現金管理邏輯。",
    exportData: "匯出配置",
    importData: "匯入配置",
    downloadReport: "下載專業報告 (PDF)",
    reportGeneratedBy: "由策略回測系統產生",
    strategyAnalysis: "投資策略績效分析報告",
    executiveSummary: "核心績效摘要",
    visualAnalysis: "圖表視覺化分析",
    aiAnalysisNote: "AI 分析專用 segment：以下數據已為 AI 解析進行結構化處理。",
    legalDisclaimer: "風險提示：本報告僅供模擬參考，過往業績不代表未來表現。投資有風險，入市需謹慎。"
  }
};

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('en');

  const t = (key: string) => {
    return dictionaries[language][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useTranslation = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useTranslation must be used within a LanguageProvider');
  }
  return context;
};
